@inject GameStateService GameState

<section class="status-panel">
    <div class="status-header">
        <h2>Game Status</h2>
        @if (GameState.GameId is not null)
        {
            <span class="badge">@GameState.Status</span>
        }
    </div>

    <dl>
        <dt>Game Id</dt>
        <dd>@(GameState.GameId?.ToString() ?? "N/A")</dd>
        <dt>Grid Size</dt>
        <dd>@GameState.GridSize</dd>
        <dt>Mode</dt>
        <dd>@(GameState.IsMultiplayer ? "Multiplayer" : "Solo")</dd>
        @if (GameState.IsMultiplayer)
        {
            <dt>Role</dt>
            <dd>@(GameState.PlayerRole == PlayerSlot.PlayerOne ? "Player One" : "Player Two")</dd>
            <dt>Turn</dt>
            <dd>@GetTurnLabel()</dd>
        }
    </dl>

    @if (!string.IsNullOrWhiteSpace(GameState.LastMessage))
    {
        <p class="info-text">@GameState.LastMessage</p>
    }

    @if (!string.IsNullOrWhiteSpace(GameState.ErrorMessage))
    {
        <p class="error-text">@GameState.ErrorMessage</p>
    }
</section>
@code {
    private string GetTurnLabel()
    {
        Console.WriteLine($"{DateTime.UtcNow:O} [GameStatusPanel] waiting={GameState.IsWaitingForOpponent}, isPlayerTurn={GameState.IsPlayerTurn}, role={GameState.PlayerRole}, status={GameState.Status}");
        if (GameState.IsMultiplayer && GameState.IsWaitingForOpponent)
        {
            return "Waiting for opponent...";
        }

        return GameState.IsPlayerTurn ? "Your turn" : "Opponent turn";
    }
}